{% extends "base.html" %}

{% block body_style %}
style="
  background-image: url({{ url_for('static', filename='img/login_bg.jpg') }});
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  height: 100vh;
"
{% endblock %}


{% block content %}
<div class="row min-vh-50 d-flex align-items-center justify-content-center">
    
    <div class="col-12 col-lg-10">
        <div class="row g-0 rounded-4 overflow-hidden shadow-lg">
            
            <div class="col-md-6 p-4 p-md-5 d-flex align-items-center login-glass-card">
                
                <div> 
                    <h1 class="h2 mb-4 text-dark">Iniciar Sesión</h1>
                    
                    <form action="" method="post" novalidate>
                        {{ form.hidden_tag() }}
                        
                        <div class="mb-3">
                            {{ form.email.label(class="form-label text-dark") }}
                            {{ form.email(class="form-control form-control-lg", size=32) }}
                            {% for error in form.email.errors %}
                            <div class="text-danger small mt-1">{{ error }}</div>
                            {% endfor %}
                        </div>
                        
                        <div class="mb-3">
                            {{ form.password.label(class="form-label text-dark") }}
                            {{ form.password(class="form-control form-control-lg", size=32) }}
                            {% for error in form.password.errors %}
                            <div class="text-danger small mt-1">{{ error }}</div>
                            {% endfor %}
                        </div>
                        
                        <div class="mb-3 form-check">
                            {{ form.remember_me(class="form-check-input") }}
                            {{ form.remember_me.label(class="form-check-label text-dark") }}
                        </div>
                        
                        <div class="d-grid">
                            {{ form.submit(class="btn btn-primary btn-lg") }}
                        </div>
                    </form>
                    
                    <hr class="my-4">
                    
                    <p class="mb-0 text-dark">¿Usuario nuevo? 
                        <a href="{{ url_for('auth.register') }}" class="fw-bold">Haz clic para registrarte</a>
                    </p>
                </div>

            </div>
            
            <div class="col-md-6 d-none d-md-block">
                <div class="login-image-placeholder h-100" 
                     data-image-url="{{ url_for('static', filename='img/login.png') }}">
                </div>
            </div>
            </div>
    </div>
</div>
{% endblock %}


{% block scripts %}
{{ super() }} 
<style>
    /* --- ¡CORRECCIÓN 3: CSS DE GLASSMORPHISM AÑADIDO! --- */
    .login-glass-card {
        /* 1. Fondo blanco semi-transparente */
        background-color: rgba(255, 255, 255, 0.7) !important;
        
        /* 2. Desenfoque de fondo */
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        
        /* 3. Borde sutil */
        border: 1px solid rgba(255, 255, 255, 0.2);
    }
    /* -------------------------------------------------- */

    .login-image-placeholder {
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        min-height: 400px;
        opacity: 0.7; /* Opacidad agregada */
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 1. Encontrar el div
    const placeholder = document.querySelector('.login-image-placeholder');
    if (placeholder) {
        // 2. Leer la URL del atributo 'data-image-url'
        const imageUrl = placeholder.dataset.imageUrl;
        
        // 3. Aplicar la URL como estilo de fondo
        if (imageUrl) {
            placeholder.style.backgroundImage = `url(${imageUrl})`;
        }
    }
});
</script>
{% endblock %}